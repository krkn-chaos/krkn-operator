{"id":"krkn-operator-3x4","title":"Authentication Middleware","description":"An authentication middleware for jwt token must be developed and applied to the existing endpoints in the following way:\n\n\n","notes":"\t# user, admin\n         mux.HandleFunc(\"/api/v1/health\", handler.HealthCheck)\n\tmux.HandleFunc(\"/api/v1/clusters\", handler.GetClusters)\n\tmux.HandleFunc(\"/api/v1/nodes\", handler.GetNodes)\n\tmux.HandleFunc(\"/api/v1/targets\", handler.TargetsHandler)  // POST, GET - legacy endpoints (KrknTargetRequest)\n\tmux.HandleFunc(\"/api/v1/targets/\", handler.TargetsHandler) // GET /{uuid} - legacy endpoint (check status)\n\n\t// Provider config endpoints (KrknOperatorTargetProviderConfig)\n         # admin\n\tmux.HandleFunc(\"/api/v1/provider-config\", handler.ProviderConfigHandler)  // POST, GET\n\tmux.HandleFunc(\"/api/v1/provider-config/\", handler.ProviderConfigHandler) // GET /{uuid}\n         # GET user, admin\n        # PATCH admin \n\tmux.HandleFunc(\"/api/v1/providers\", handler.ProvidersRouter)              // GET, PATCH\n\tmux.HandleFunc(\"/api/v1/providers/\", handler.ProvidersRouter)\n\n\t// CRUD endpoints for KrknOperatorTarget (operator-managed targets)\n         # POST, PUT DELETE admin\n          # GET user, admin\n\tmux.HandleFunc(\"/api/v1/operator/targets\", handler.TargetsCRUDRouter)  // POST, GET\n\tmux.HandleFunc(\"/api/v1/operator/targets/\", handler.TargetsCRUDRouter) // GET, PUT, DELETE /{uuid}\n\n\t// Scenario management endpoints\n         # user, admin\n\tmux.HandleFunc(\"/api/v1/scenarios\", handler.PostScenarios)                // POST - list scenarios\n\tmux.HandleFunc(\"/api/v1/scenarios/detail/\", handler.PostScenarioDetail)   // POST /{scenario_name}\n\tmux.HandleFunc(\"/api/v1/scenarios/globals/\", handler.PostScenarioGlobals) // POST /{scenario_name}\n\tmux.HandleFunc(\"/api/v1/scenarios/run\", handler.ScenariosRunRouter)       // POST, GET\n\tmux.HandleFunc(\"/api/v1/scenarios/run/\", handler.ScenariosRunRouter)      // GET, DELETE /{jobId}","status":"closed","priority":1,"issue_type":"feature","owner":"tsebasti@redhat.com","created_at":"2026-02-26T11:13:08Z","created_by":"Tullio Sebastiani","updated_at":"2026-02-26T13:19:59Z","closed_at":"2026-02-26T13:19:59Z","close_reason":"Authentication middleware implemented and applied to all REST endpoints. Includes JWT validation, role-based authorization (admin/user), and method-based access control","dependencies":[{"issue_id":"krkn-operator-3x4","depends_on_id":"krkn-operator-ikb","type":"blocks","created_at":"2026-02-26T12:17:30Z","created_by":"Tullio Sebastiani","metadata":"{}"}]}
{"id":"krkn-operator-8xa","title":"Fix broken API and controller tests","description":"Multiple test suites are failing due to outdated test code:\n\n1. internal/api tests: Still using old clusterNames format instead of targetClusters map\n2. internal/controller tests: Scheme setup issues preventing Secret registration\n\nThese tests were broken before the KrknUser CRD work and need to be fixed separately.\n\nFiles affected:\n- internal/api/handlers_test.go\n- internal/controller/*_test.go","status":"open","priority":2,"issue_type":"task","owner":"tsebasti@redhat.com","created_at":"2026-02-26T11:28:11Z","created_by":"Tullio Sebastiani","updated_at":"2026-02-26T11:28:11Z"}
{"id":"krkn-operator-hvk","title":"KrknUser CRD","description":"Create a CRD named KrknUser that will work as authentication entity for the REST APIS. \nThis CRD will have a secret related to each instance of it containing the hash of the password. The KrknUser CRD will have the following attributes:\nuserId: will be the email of the user\n- Name\n- Surname\n- Organization\n- Role: user/admin\n- Created: date\n- Active: bool\n\nThe CRD will be marked with the following labels:\nkrkn.krkn-chaos.dev=user-account\nkrkn.krkn-chaos.dev=\u003crole\u003e\n\nRemember to update kustomize in order to have it installed via make install","status":"closed","priority":1,"issue_type":"feature","owner":"tsebasti@redhat.com","created_at":"2026-02-26T11:02:29Z","created_by":"Tullio Sebastiani","updated_at":"2026-02-26T11:27:59Z","closed_at":"2026-02-26T11:27:59Z","close_reason":"KrknUser CRD implementation complete with full test coverage"}
{"id":"krkn-operator-ikb","title":"Login rest endpoint","description":"# utility endpoints\n# /isRegistered\nwill check if any krkn.krkn-chaos.dev=admin labeled CRD is present \n# login endpoints\n## /register\nif no admin users are registered will allow authentication free registration (first registration) only for one admin user otherwise will be possible only for admin users to register new user (both user and admin level)\n## /login\nwill return a jwt token that will authenticate all the other REST calls.","status":"closed","priority":1,"issue_type":"feature","owner":"tsebasti@redhat.com","created_at":"2026-02-26T11:05:46Z","created_by":"Tullio Sebastiani","updated_at":"2026-02-26T11:43:10Z","closed_at":"2026-02-26T11:43:10Z","close_reason":"Login REST endpoints implemented with full test coverage. Includes /is-registered, /register, and /login endpoints, plus reusable JWT and password utilities in pkg/auth","dependencies":[{"issue_id":"krkn-operator-ikb","depends_on_id":"krkn-operator-hvk","type":"blocks","created_at":"2026-02-26T12:16:57Z","created_by":"Tullio Sebastiani","metadata":"{}"}]}
{"id":"krkn-operator-y97","title":"Login \u0026 Authentication","description":"Create a login and authentication method for krkn-operator REST APIs\n","status":"closed","priority":1,"issue_type":"epic","owner":"tsebasti@redhat.com","created_at":"2026-02-26T10:57:25Z","created_by":"Tullio Sebastiani","updated_at":"2026-02-26T13:29:23Z","closed_at":"2026-02-26T13:29:23Z","close_reason":"Epic completed: Full authentication system implemented with KrknUser CRD, login/register endpoints, JWT authentication, and middleware for all REST APIs"}
